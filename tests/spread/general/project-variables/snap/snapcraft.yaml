name: project-variables
base: core20
version: '1.0'
summary: test
description: |
  Project variables should be evaluated in $VAR or ${VAR} form.
  Larger variable names should be evaluated first (`SNAPCRAFT_ARCH_TRIPLET_BUILD_{ON|FOR}`
  should be evaluated before `SNAPCRAFT_ARCH_TRIPLET`.
grade: stable
confinement: strict

architectures:
  - build-on: amd64
    run-on: armhf

environment:
  SNAPCRAFT_ARCH_TRIPLET_1: $SNAPCRAFT_ARCH_TRIPLET
  SNAPCRAFT_ARCH_TRIPLET_2: ${SNAPCRAFT_ARCH_TRIPLET}
  SNAPCRAFT_ARCH_TRIPLET_BUILD_FOR_1: $SNAPCRAFT_ARCH_TRIPLET_BUILD_FOR
  SNAPCRAFT_ARCH_TRIPLET_BUILD_FOR_2: ${SNAPCRAFT_ARCH_TRIPLET_BUILD_FOR}
  SNAPCRAFT_ARCH_TRIPLET_BUILD_ON_1: $SNAPCRAFT_ARCH_TRIPLET_BUILD_ON
  SNAPCRAFT_ARCH_TRIPLET_BUILD_ON_2: ${SNAPCRAFT_ARCH_TRIPLET_BUILD_ON}

parts:
  my-part:
    plugin: nil
    source: .
    source-subdir: foo
    override-build: |
      cat << EOF >> $SNAPCRAFT_PART_INSTALL/part-variables.txt
      SNAPCRAFT_PART_SRC_1: $SNAPCRAFT_PART_SRC
      SNAPCRAFT_PART_SRC_2: ${SNAPCRAFT_PART_SRC}
      SNAPCRAFT_PART_SRC_WORK_1: $SNAPCRAFT_PART_SRC_WORK
      SNAPCRAFT_PART_SRC_WORK_2: ${SNAPCRAFT_PART_SRC_WORK}
      SNAPCRAFT_ARCH_TRIPLET_1: $SNAPCRAFT_ARCH_TRIPLET
      SNAPCRAFT_ARCH_TRIPLET_2: ${SNAPCRAFT_ARCH_TRIPLET}
      SNAPCRAFT_ARCH_TRIPLET_BUILD_FOR_1: $SNAPCRAFT_ARCH_TRIPLET_BUILD_FOR
      SNAPCRAFT_ARCH_TRIPLET_BUILD_FOR_2: ${SNAPCRAFT_ARCH_TRIPLET_BUILD_FOR}
      SNAPCRAFT_ARCH_TRIPLET_BUILD_ON_1: $SNAPCRAFT_ARCH_TRIPLET_BUILD_ON
      SNAPCRAFT_ARCH_TRIPLET_BUILD_ON_2: ${SNAPCRAFT_ARCH_TRIPLET_BUILD_ON}
      EOF
