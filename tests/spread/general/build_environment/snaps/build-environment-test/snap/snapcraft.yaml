name: build-environment-test
version: "1.0"
summary: Quick snap to ensure build-environment works
description: Quick snap to ensure build-environment works

base: core22
grade: devel
confinement: strict

apps:
  build-environment-test:
    command: echo.sh

parts:
  part1:
    plugin: dump
    source: .
    override-build: |
      echo "part1: $FOO"
      craftctl default
    build-environment:
      - FOO: BAR

  part2:
    plugin: nil
    after: [part1]
    override-build: |
      echo "part2: $FOO"
    build-environment:
      # craft-parts uses "set -u" for unbound variables, so we use '${var -}' to only print the variable if it exists
      - FOO: "${FOO-} BAZ"
      - FOO: "${FOO-} QUX"
